<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Postagens</title>
</head>
<style>
    textarea {
        width: 25%;
        height: 20px;
        padding: 10px;
        font-size: 16px;
        resize: vertical;
        }
</style>
<body>
    <form id="postForm">
        <label>Título: </label><br>
        <input type="text" id="titulo"><br>
        <label>Corpo do Texto: </label><br>
        <textarea id="corpo" placeholder="Escreva algo..." rows="2"></textarea><br>
        <!--<label>Autor: </label>-->
        <!--<input type="number" id="autor">-->
        <label>Categoria: </label><br>
        <input type="text" id="categoria"><br>
        <!--<input type="file" name="imagem">-->
        <input type="submit" value="Enviar">
    </form>
    <div id="mensagem"></div>
</body>
</html>

<script>
    document.getElementById("postForm").addEventListener("submit", async function (event) {
        event.preventDefault(); // Impede o reload da página

        const titulo = document.getElementById("titulo").value;
        const corpo = document.getElementById("corpo").value;
        const categoria = document.getElementById("categoria").value;

        try {
        // Envia os dados para a API via fetch (requisição assíncrona)
        const resposta = await fetch("/api/send-post", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ titulo, corpo, categoria})
        });

        // Lê o resultado da resposta da API
        const resultado = await resposta.json();
        document.getElementById("mensagem").innerText = resultado.message;

        // Se a requisição foi bem-sucedida, reseta o formulário
        if (resposta.ok) {
            document.getElementById("postForm").reset();
        }
    } catch (error) {
        // Caso aconteça algum erro, exibe a mensagem de erro
        document.getElementById("mensagem").innerText = `Erro: ${error.message}`;
    }
});
</script>
